(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-60a692d2"],{"838a":function(e,t,s){"use strict";s.d(t,"f",(function(){return r})),s.d(t,"c",(function(){return i})),s.d(t,"g",(function(){return o})),s.d(t,"e",(function(){return a})),s.d(t,"d",(function(){return l})),s.d(t,"b",(function(){return c})),s.d(t,"h",(function(){return u})),s.d(t,"a",(function(){return d}));var n=s("66df"),r=function(e){return n["a"].request({url:"rbac/role/list",method:"post",data:e})},i=function(e){return n["a"].request({url:"rbac/role/create",method:"post",data:e})},o=function(e){return n["a"].request({url:"rbac/role/edit/"+e.guid,method:"get"})},a=function(e){return n["a"].request({url:"rbac/role/edit",method:"post",data:e})},l=function(e){return n["a"].request({url:"rbac/role/delete/"+e,method:"get"})},c=function(e){return n["a"].request({url:"rbac/role/batch",method:"get",params:e})},u=function(){return n["a"].request({url:"rbac/role/find_simple_list",method:"get"})},d=function(e){return n["a"].request({url:"rbac/role/assign_permission",method:"post",data:e})}},a8ba:function(e,t,s){"use strict";s.d(t,"e",(function(){return r})),s.d(t,"b",(function(){return i})),s.d(t,"f",(function(){return o})),s.d(t,"d",(function(){return a})),s.d(t,"c",(function(){return l})),s.d(t,"a",(function(){return c})),s.d(t,"g",(function(){return u}));var n=s("66df"),r=function(e){return n["a"].request({url:"rbac/permission/list",method:"post",data:e})},i=function(e){return n["a"].request({url:"rbac/permission/create",method:"post",data:e})},o=function(e){return n["a"].request({url:"rbac/permission/edit/"+e.code,method:"get"})},a=function(e){return n["a"].request({url:"rbac/permission/edit",method:"post",data:e})},l=function(e){return n["a"].request({url:"rbac/permission/delete/"+e,method:"get"})},c=function(e){return n["a"].request({url:"rbac/permission/batch",method:"get",params:e})},u=function(e){return n["a"].request({url:"rbac/permission/permission_tree/"+e,method:"get"})}},cb14:function(e,t,s){},d7a6:function(e,t,s){"use strict";var n=s("cb14"),r=s.n(n);r.a},df67:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Card",[s("Row",{attrs:{gutter:15}},[s("Col",{attrs:{span:"4"}},[s("h3",{staticStyle:{"background-color":"#f3f3f3","margin-bottom":"0",padding:"5px 5px 5px 10px",position:"relative"}},[e._v("角色列表 "),s("span",{staticStyle:{display:"inline-block",position:"absolute",right:"6px",top:"4px"}},[s("Tooltip",{attrs:{content:"刷新角色列表"}},[s("Button",{attrs:{shape:"circle",size:"small",icon:"md-refresh"},on:{click:e.handleReloadRoleListClick}})],1)],1)]),s("ul",{staticClass:"role-list-box"},e._l(e.stores.role.data,(function(t){return s("li",{class:{active:t.selected},on:{click:function(s){return e.handleRoleClicked(t)}}},[e._v(e._s(t.roleName))])})),0)]),s("Col",{attrs:{span:"20"}},[s("div",{staticStyle:{"margin-bottom":"10px"}},[s("h3",{staticStyle:{"background-color":"#f3f3f3","margin-bottom":"0",padding:"5px 5px 5px 10px"}},[e._v("权限列表")]),s("span",{staticStyle:{display:"inline-block",position:"absolute",right:"0",top:"1px"}},[s("Button",{directives:[{name:"can",rawName:"v-can",value:"save",expression:"'save'"}],attrs:{icon:"md-checkmark-circle",type:"primary"},on:{click:e.handleSaveRolePermissions}},[e._v("保 存")])],1)]),s("Tree",{staticClass:"permission-tree-box",attrs:{data:e.stores.permissionTree.data,render:e.renderContent}})],1)],1)],1)],1)},r=[],i=(s("7f7f"),s("838a")),o=s("a8ba"),a={name:"rbac_role_permission_page",data:function(){return{selectedPermissions:[],currentRoleCode:"",stores:{role:{data:[]},permissionTree:{data:[]}},buttonProps:{type:"default",size:"small"}}},mounted:function(){this.loadRoles()},methods:{loadRoles:function(){var e=this;Object(i["h"])().then((function(t){for(var s=t.data.data,n=0,r=s.length;n<r;n++)s[n].selected=!1;e.stores.role.data=s}))},loadRolePermissionTree:function(){var e=this;Object(o["g"])(this.currentRoleCode).then((function(t){var s=t.data.data;e.stores.permissionTree.data=s.tree,e.selectedPermissions=s.selectedPermissions}))},handleRoleClicked:function(e){for(var t=0,s=this.stores.role.data.length;t<s;t++)this.stores.role.data[t].selected=!1;this.currentRoleCode=e.systemRoleUuid,e.selected=!0,this.loadRolePermissionTree()},handleSaveRolePermissions:function(){var e=this,t={roleCode:this.currentRoleCode,permissions:this.selectedPermissions};Object(i["a"])(t).then((function(t){var s=t.data;200==s.code?e.$Message.success(s.message):e.$Message.warning(s.message)}))},handleReloadRoleListClick:function(){this.currentRoleCode="",this.selectedPermissions=[],this.stores.permissionTree.data=[],this.loadRoles()},renderContent:function(e,t){var s=this,n=(t.root,t.node),r=t.data,i=!1;return r.permissions&&r.permissions.length>0&&(i=!0),e("span",{style:{display:"inline-block",width:"100%"},class:"permission-tree-node"},[e("span",[e("Icon",{props:{type:"ios-paper-outline"},style:{marginRight:"5px"}}),e("span",r.title)]),e("span",{style:{display:"inline-block",float:"right",marginRight:"32px"}},[e("div",{style:{display:"inline-block",marginRight:"10px"}},[e("CheckboxGroup",{props:{value:this.selectedPermissions,style:{display:"inline-block"},class:"permission-box"},on:{"on-change":function(e){s.selectedPermissions=e}}},(r.permissions||[]).map((function(t){return e("Checkbox",{props:{label:t.code}},t.name)})))]),e("Checkbox",{props:{label:"全选",value:r.allAssigned},style:{marginLeft:"15px",color:"333",fontWeight:"600",visibility:i?"visible":"hidden"},class:"permission-check-all",on:{"on-change":function(e){s.checkNodePermission(e,r.permissions,n)}}},"全选")])])},checkNodePermission:function(e,t,s){if(s.allAssigned=e,t&&!(t.length<=0))if(e)for(var n=0,r=t.length;n<r;n++){var i=t[n],o=this.selectedPermissions.indexOf(i.code);-1==o&&this.selectedPermissions.push(i.code)}else for(var a=0,l=t.length;a<l;a++){i=t[a],o=this.selectedPermissions.indexOf(i.code);-1!==o&&this.selectedPermissions.splice(o,1)}}}},l=a,c=(s("d7a6"),s("2877")),u=Object(c["a"])(l,n,r,!1,null,null,null);t["default"]=u.exports}}]);