(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b9a9cc5"],{"2f21":function(e,t,r){"use strict";var a=r("79e5");e.exports=function(e,t){return!!e&&a((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},"3b2b":function(e,t,r){var a=r("7726"),s=r("5dbc"),o=r("86cc").f,n=r("9093").f,i=r("aae3"),l=r("0bfb"),d=a.RegExp,u=d,c=d.prototype,f=/a/g,m=/a/g,h=new d(f)!==f;if(r("9e1e")&&(!h||r("79e5")((function(){return m[r("2b4c")("match")]=!1,d(f)!=f||d(m)==m||"/a/i"!=d(f,"i")})))){d=function(e,t){var r=this instanceof d,a=i(e),o=void 0===t;return!r&&a&&e.constructor===d&&o?e:s(h?new u(a&&!o?e.source:e,t):u((a=e instanceof d)?e.source:e,a&&o?l.call(e):t),r?this:c,d)};for(var p=function(e){e in d||o(d,e,{configurable:!0,get:function(){return u[e]},set:function(t){u[e]=t}})},g=n(u),v=0;g.length>v;)p(g[v++]);c.constructor=d,d.prototype=c,r("2aba")(a,"RegExp",d)}r("7a56")("RegExp")},"55dd":function(e,t,r){"use strict";var a=r("5ca1"),s=r("d8e8"),o=r("4bf8"),n=r("79e5"),i=[].sort,l=[1,2,3];a(a.P+a.F*(n((function(){l.sort(void 0)}))||!n((function(){l.sort(null)}))||!r("2f21")(i)),"Array",{sort:function(e){return void 0===e?i.call(o(this)):i.call(o(this),s(e))}})},"627a":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s}));r("28a5"),r("3b2b");var a=function(e,t,r){if(""!==t&&null!==t){var a=/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;a.test(t)||r(new Error("请输入有效的邮箱"))}else r(new Error("请输入有效的邮箱"));r()},s=function(e,t,r){console.log(t),null!=t&&""!=t.trim()||r(new Error("请输入字符")),r()}},"838a":function(e,t,r){"use strict";r.d(t,"f",(function(){return s})),r.d(t,"c",(function(){return o})),r.d(t,"g",(function(){return n})),r.d(t,"e",(function(){return i})),r.d(t,"d",(function(){return l})),r.d(t,"b",(function(){return d})),r.d(t,"h",(function(){return u})),r.d(t,"a",(function(){return c}));var a=r("66df"),s=function(e){return a["a"].request({url:"rbac/role/list",method:"post",data:e})},o=function(e){return a["a"].request({url:"rbac/role/create",method:"post",data:e})},n=function(e){return a["a"].request({url:"rbac/role/edit/"+e.guid,method:"get"})},i=function(e){return a["a"].request({url:"rbac/role/edit",method:"post",data:e})},l=function(e){return a["a"].request({url:"rbac/role/delete/"+e,method:"get"})},d=function(e){return a["a"].request({url:"rbac/role/batch",method:"get",params:e})},u=function(){return a["a"].request({url:"rbac/role/find_simple_list",method:"get"})},c=function(e){return a["a"].request({url:"rbac/role/assign_permission",method:"post",data:e})}},aa73:function(e,t,r){},b1e8:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Card",[r("dz-table",{attrs:{totalCount:e.stores.user.query.totalCount,pageSize:e.stores.user.query.pageSize},on:{"on-page-change":e.handlePageChanged,"on-page-size-change":e.handlePageSizeChanged}},[r("div",{attrs:{slot:"searcher"},slot:"searcher"},[r("section",{staticClass:"dnc-toolbar-wrap"},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{span:"16"}},[r("Form",{attrs:{inline:""},nativeOn:{submit:function(e){e.preventDefault()}}},[r("FormItem",[r("Input",{attrs:{type:"text",search:"",clearable:!0,placeholder:"输入关键字搜索..."},on:{"on-search":function(t){return e.handleSearchUser()}},model:{value:e.stores.user.query.kw,callback:function(t){e.$set(e.stores.user.query,"kw",t)},expression:"stores.user.query.kw"}},[r("Select",{staticStyle:{width:"60px"},attrs:{slot:"prepend",placeholder:"删除状态"},on:{"on-change":e.handleSearchUser},slot:"prepend",model:{value:e.stores.user.query.isDeleted,callback:function(t){e.$set(e.stores.user.query,"isDeleted",t)},expression:"stores.user.query.isDeleted"}},e._l(e.stores.user.sources.isDeletedSources,(function(t){return r("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.text))])})),1)],1)],1)],1)],1),r("Col",{staticClass:"dnc-toolbar-btns",attrs:{span:"8"}},[r("ButtonGroup",{staticClass:"mr3"},[r("Button",{directives:[{name:"can",rawName:"v-can",value:"delete",expression:"'delete'"}],staticClass:"txt-danger",attrs:{icon:"md-trash",title:"删除"},on:{click:function(t){return e.handleBatchCommand("delete")}}}),r("Button",{directives:[{name:"can",rawName:"v-can",value:"huifu",expression:"'huifu'"}],staticClass:"txt-success",attrs:{icon:"md-redo",title:"恢复"},on:{click:function(t){return e.handleBatchCommand("recover")}}}),r("Button",{attrs:{icon:"md-refresh",title:"刷新"},on:{click:e.handleRefresh}})],1),r("Button",{directives:[{name:"can",rawName:"v-can",value:"create",expression:"'create'"}],attrs:{icon:"md-create",type:"primary",title:"新增用户"},on:{click:e.handleShowCreateWindow}},[e._v("新增用户")]),r("Button",{directives:[{name:"can",rawName:"v-can",value:"tongbu",expression:"'tongbu'"}],attrs:{icon:"md-create",type:"warning",title:"同步"},on:{click:e.tongbu}},[e._v("同步")])],1)],1)],1)]),r("Table",{ref:"tables",attrs:{slot:"table",border:!1,size:"small","highlight-row":!0,data:e.stores.user.data,columns:e.stores.user.columns,"row-class-name":e.rowClsRender},on:{"on-select":e.handleSelect,"on-selection-change":e.handleSelectionChange,"on-refresh":e.handleRefresh,"on-page-change":e.handlePageChanged,"on-page-size-change":e.handlePageSizeChanged,"on-sort-change":e.handleSortChange},slot:"table",scopedSlots:e._u([{key:"userType",fn:function(t){var a=t.row;t.index;return[r("span",[e._v(e._s(e.renderUserType(a.userType)))])]}},{key:"status",fn:function(t){var a=t.row;t.index;return[r("Tag",{attrs:{color:e.renderStatus(a.status).color}},[e._v(e._s(e.renderStatus(a.status).text))])]}},{key:"action",fn:function(t){var a=t.row;t.index;return[r("Poptip",{attrs:{confirm:"",transfer:!0,title:"确定要删除吗?"},on:{"on-ok":function(t){return e.handleDelete(a)}}},[r("Tooltip",{attrs:{placement:"top",content:"删除",delay:1e3,transfer:!0}},[r("Button",{directives:[{name:"can",rawName:"v-can",value:"delete1",expression:"'delete1'"}],attrs:{type:"error",size:"small",shape:"circle",icon:"md-trash"}})],1)],1),r("Tooltip",{attrs:{placement:"top",content:"编辑",delay:1e3,transfer:!0}},[r("Button",{directives:[{name:"can",rawName:"v-can",value:"edit",expression:"'edit'"}],attrs:{type:"primary",size:"small",shape:"circle",icon:"md-create"},on:{click:function(t){return e.handleEdit(a)}}})],1)]}}])})],1)],1),r("Drawer",{attrs:{title:e.formTitle,width:"600","mask-closable":!1,mask:!0,styles:e.styles},model:{value:e.formModel.opened,callback:function(t){e.$set(e.formModel,"opened",t)},expression:"formModel.opened"}},[r("Form",{ref:"formUser",attrs:{model:e.formModel.fields,rules:e.formModel.rules,"label-position":"top"}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{span:"12"}},[r("FormItem",{attrs:{label:"登录名",prop:"loginName"}},[r("Input",{attrs:{readonly:"edit"==e.formModel.mode,placeholder:"请输入登录名"},model:{value:e.formModel.fields.loginName,callback:function(t){e.$set(e.formModel.fields,"loginName",t)},expression:"formModel.fields.loginName"}})],1)],1),r("Col",{attrs:{span:"12"}},[r("FormItem",{attrs:{label:"真实名",prop:"realName"}},[r("Input",{attrs:{placeholder:"请输入真实名"},model:{value:e.formModel.fields.realName,callback:function(t){e.$set(e.formModel.fields,"realName",t)},expression:"formModel.fields.realName"}})],1)],1)],1),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{span:"12"}},[r("FormItem",{attrs:{label:"密码",prop:"passWord"}},[r("Input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{type:"password"},model:{value:e.formModel.fields.passWord,callback:function(t){e.$set(e.formModel.fields,"passWord",t)},expression:"formModel.fields.passWord"}}),r("Input",{attrs:{type:"password",placeholder:"请输入登录密码"},model:{value:e.formModel.fields.passWord,callback:function(t){e.$set(e.formModel.fields,"passWord",t)},expression:"formModel.fields.passWord"}})],1)],1),r("Col",{attrs:{span:"12"}},[r("FormItem",{attrs:{label:"角色",prop:"systemRoleUuid"}},[r("Select",{model:{value:e.formModel.fields.systemRoleUuid,callback:function(t){e.$set(e.formModel.fields,"systemRoleUuid",t)},expression:"formModel.fields.systemRoleUuid"}},e._l(e.rolelist,(function(t){return r("Option",{key:t.systemRoleUuid,attrs:{value:t.systemRoleUuid}},[e._v(e._s(t.roleName))])})),1)],1)],1)],1),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{span:"12"}},[r("FormItem",{attrs:{label:"身份证号",prop:"userIdCard"}},[r("Input",{attrs:{placeholder:"请输入身份证号"},model:{value:e.formModel.fields.userIdCard,callback:function(t){e.$set(e.formModel.fields,"userIdCard",t)},expression:"formModel.fields.userIdCard"}})],1)],1),r("Col",{attrs:{span:"12"}},[r("FormItem",{attrs:{label:"电子邮箱",prop:"oldCard"}},[r("Input",{attrs:{placeholder:"请输入电子邮箱"},model:{value:e.formModel.fields.oldCard,callback:function(t){e.$set(e.formModel.fields,"oldCard",t)},expression:"formModel.fields.oldCard"}})],1)],1)],1)],1),r("div",{staticClass:"demo-drawer-footer"},[r("Button",{attrs:{icon:"md-checkmark-circle",type:"primary"},on:{click:e.handleSubmitUser}},[e._v("保 存")]),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"md-close"},on:{click:function(t){e.formModel.opened=!1}}},[e._v("取 消")])],1)],1)],1)},s=[],o=(r("55dd"),r("dc44")),n=r("66df"),i=function(e){return n["a"].request({url:"rbac/user/list",method:"post",data:e})},l=function(){return n["a"].request({url:"DingDing/DingDing/getalluseranddep",method:"get"})},d=function(e){return n["a"].request({url:"rbac/user/create",method:"post",data:e})},u=function(e){return n["a"].request({url:"rbac/user/edit/"+e.guid,method:"get"})},c=function(e){return n["a"].request({url:"rbac/user/edit",method:"post",data:e})},f=function(e){return n["a"].request({url:"rbac/user/delete/"+e,method:"get"})},m=function(e){return n["a"].request({url:"rbac/user/batch",method:"get",params:e})},h=r("838a"),p=(r("c60f"),r("627a")),g={name:"rbac_user_page",components:{DzTable:o["a"]},data:function(){return{commands:{delete:{name:"delete",title:"删除"},recover:{name:"recover",title:"恢复"}},formModel:{opened:!1,title:"创建用户",mode:"create",selection:[],fields:{loginName:"",realName:"",passWord:"",userType:0,oldCard:"",isDeleted:0,systemRoleUuid:"",userIdCard:"",departmentUuid:""},rules:{loginName:[{type:"string",required:!0,message:"请输入登录名"}],systemRoleUuid:[{type:"string",required:!0,message:"请选择角色"}],passWord:[{type:"string",required:!0,message:"请输入密码"}],oldCard:[{type:"string",required:!0,validator:p["a"]}]}},formAssignRole:{userGuid:"",opened:!1,ownedRoles:[],inited:!1,roles:[]},stores:{user:{query:{totalCount:0,pageSize:20,currentPage:1,kw:"",isDeleted:0,status:-1,sort:[{direct:"DESC",field:"ID"}]},sources:{userTypes:[{value:0,text:"超级管理员"},{value:1,text:"管理员"},{value:2,text:"普通用户"}],isDeletedSources:[{value:-1,text:"全部"},{value:0,text:"正常"},{value:1,text:"已删"}],statusSources:[{value:-1,text:"全部"},{value:0,text:"禁用"},{value:1,text:"正常"}],statusFormSources:[{value:0,text:"禁用"},{value:1,text:"正常"}]},columns:[{type:"selection",width:35,key:"handle"},{title:"登录名",key:"loginName",minWidth:150,maxWidth:200,sortable:!0},{title:"真实名",key:"realName",minWidth:80,maxWidth:100},{title:"身份证号",key:"userIdCard",minWidth:140},{title:"创建时间",ellipsis:!0,tooltip:!0,key:"addTime",minWidth:130,maxWidth:140},{title:"操作",align:"center",minWidth:130,maxWidth:150,className:"table-command-column",slot:"action"}],data:[]}},styles:{height:"calc(100% - 55px)",overflow:"auto",paddingBottom:"53px",position:"static"},rolelist:[],departmentlist:[]}},computed:{formTitle:function(){return"create"===this.formModel.mode?"创建用户":"edit"===this.formModel.mode?"编辑用户":""},selectedRows:function(){return this.formModel.selection},selectedRowsId:function(){return this.formModel.selection.map((function(e){return e.systemUserUuid}))}},methods:{loadUserList:function(){var e=this;i(this.stores.user.query).then((function(t){e.stores.user.data=t.data.data,e.stores.user.query.totalCount=t.data.totalCount}))},doloadRoleList:function(){var e=this;Object(h["h"])().then((function(t){e.rolelist=t.data.data}))},handleOpenFormWindow:function(){this.formModel.opened=!0},handleCloseFormWindow:function(){this.formModel.opened=!1},handleSwitchFormModeToCreate:function(){this.formModel.mode="create"},handleSwitchFormModeToEdit:function(){this.formModel.mode="edit",this.handleOpenFormWindow()},handleEdit:function(e){this.handleSwitchFormModeToEdit(),this.handleResetFormUser(),this.doLoadUser(e.systemUserUuid)},handleSelect:function(e,t){},handleSelectionChange:function(e){this.formModel.selection=e},handleRefresh:function(){this.loadUserList()},handleShowCreateWindow:function(){this.handleSwitchFormModeToCreate(),this.handleOpenFormWindow(),this.handleResetFormUser()},handleSubmitUser:function(){var e=this.validateUserForm();e&&("create"===this.formModel.mode&&this.doCreateUser(),"edit"===this.formModel.mode&&this.doEditUser())},handleResetFormUser:function(){this.$refs["formUser"].resetFields()},doCreateUser:function(){var e=this,t=/^[^\s]+$/;if(t.test(this.formModel.fields.loginName)){var r=/^[^\s]+$/;r.test(this.formModel.fields.passWord)?(console.log(this.formModel.fields),d(this.formModel.fields).then((function(t){200===t.data.code?(e.$Message.success(t.data.message),e.handleCloseFormWindow(),e.loadUserList()):e.$Message.warning(t.data.message)}))):this.$Message.warning("请输入有效的密码")}else this.$Message.warning("请输入有效的名称")},doEditUser:function(){var e=this,t=/^[^\s]+$/;if(t.test(this.formModel.fields.loginName)){var r=/^[^\s]+$/;r.test(this.formModel.fields.passWord)?c(this.formModel.fields).then((function(t){200===t.data.code?(e.$Message.success(t.data.message),e.handleCloseFormWindow(),e.loadUserList()):e.$Message.warning(t.data.message)})):this.$Message.warning("请输入有效的密码")}else this.$Message.warning("请输入有效的名称")},validateUserForm:function(){var e=this,t=!1;return this.$refs["formUser"].validate((function(r){r?t=!0:e.$Message.error("请完善表单信息")})),t},doLoadUser:function(e){var t=this;u({guid:e}).then((function(e){t.formModel.fields=e.data.data}))},handleDelete:function(e){this.doDelete(e.systemUserUuid)},doDelete:function(e){var t=this;e?f(e).then((function(e){200===e.data.code?(t.$Message.success(e.data.message),t.loadUserList(),t.formModel.selection=[]):t.$Message.warning(e.data.message)})):this.$Message.warning("请选择至少一条数据")},handleBatchCommand:function(e){var t=this;!this.selectedRowsId||this.selectedRowsId.length<=0?this.$Message.warning("请选择至少一条数据"):this.$Modal.confirm({title:"操作提示",content:"<p>确定要执行当前 ["+this.commands[e].title+"] 操作吗?</p>",loading:!0,onOk:function(){t.doBatchCommand(e)}})},doBatchCommand:function(e){var t=this;m({command:e,ids:this.selectedRowsId.join(",")}).then((function(e){200===e.data.code?(t.$Message.success(e.data.message),t.loadUserList(),t.formModel.selection=[]):t.$Message.warning(e.data.message),t.$Modal.remove()}))},handleSearchUser:function(){this.loadUserList()},rowClsRender:function(e,t){return e.isDeleted?"table-row-disabled":""},handleSortChange:function(e){this.stores.user.query.sort.direction=e.order,this.stores.user.query.sort.field=e.key,this.loadUserList()},handlePageChanged:function(e){this.stores.user.query.currentPage=e,this.loadUserList()},handlePageSizeChanged:function(e){this.stores.user.query.pageSize=e,this.loadUserList()},tongbu:function(){var e=this;this.$Modal.confirm({title:"操作提示",content:"<p>确定要同步钉钉的人员信息和统一身份信息吗?</p>",loading:!0,onOk:function(){l().then((function(t){200===t.data.code?(e.$Message.success(t.data.message),e.loadUserList(),e.$Modal.remove()):(e.$Message.warning(t.data.message),e.$Modal.remove())}))}})},renderUserType:function(e){var t="未知";switch(e){case 0:t="超级管理员";break;case 1:t="管理员";break;case 2:t="普通用户";break}return t},renderStatus:function(e){var t={color:"success",text:"正常"};switch(e){case 0:t.text="禁用",t.color="error";break}return t}},mounted:function(){this.loadUserList(),this.doloadRoleList()}},v=g,b=r("2877"),w=Object(b["a"])(v,a,s,!1,null,null,null);t["default"]=w.exports},bc57:function(e,t,r){"use strict";var a=r("aa73"),s=r.n(a);s.a},c60f:function(e,t,r){"use strict";r.d(t,"e",(function(){return s})),r.d(t,"b",(function(){return o})),r.d(t,"f",(function(){return n})),r.d(t,"d",(function(){return i})),r.d(t,"c",(function(){return l})),r.d(t,"a",(function(){return d}));var a=r("66df"),s=function(e){return a["a"].request({url:"rbac/department/list",method:"post",data:e})},o=function(e){return a["a"].request({url:"rbac/department/create",method:"post",data:e})},n=function(e){return a["a"].request({url:"rbac/department/edit/"+e.guid,method:"get"})},i=function(e){return a["a"].request({url:"rbac/department/edit",method:"post",data:e})},l=function(e){return a["a"].request({url:"rbac/department/delete/"+e,method:"get"})},d=function(e){return a["a"].request({url:"rbac/department/batch",method:"get",params:e})}},dc44:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"dnc-table-wrap"},[e._t("searcher",[e.searchable&&"top"===e.searchPlace?r("div",{staticClass:"search-con search-con-top"},[r("Input",{staticClass:"search-input",attrs:{clearable:"",placeholder:"输入关键字搜索"},on:{"on-change":e.handleClear},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}}),r("Button",{staticClass:"search-btn",attrs:{type:"primary"},on:{click:e.handleSearch}},[r("Icon",{attrs:{type:"search"}}),e._v(" 搜索 ")],1)],1):e._e()]),e._t("table",[e._v("暂无数据")]),r("div",{staticStyle:{"margin-top":"15px"}},[e._t("pager",[r("Page",{attrs:{total:e.totalCount,"page-size":e.pageSize,size:"small","show-elevator":"","show-sizer":"","show-total":"","page-size-opts":e.pageSizeOpts},on:{"on-change":e.onPageChanged,"on-page-size-change":e.onPageSizeChanged}})])],2)],2)},s=[],o=(r("c5f6"),{name:"DzTable",data:function(){return{searchValue:""}},props:{searchable:{type:Boolean,default:!1},searchPlace:{type:String,default:"top"},totalCount:{type:Number,default:0},pageSize:{type:Number,default:20},showRefreshButton:{type:Boolean,default:!1},pageSizeOpts:{type:Array,default:function(){return[5,10,20,30,40,50]}}},methods:{handleClear:function(){},handleSearch:function(){this.$emit("on-search")},onPageChanged:function(e){this.$emit("on-page-change",e)},onPageSizeChanged:function(e){this.$emit("on-page-size-change",e)}}}),n=o,i=(r("bc57"),r("2877")),l=Object(i["a"])(n,a,s,!1,null,null,null);t["a"]=l.exports}}]);